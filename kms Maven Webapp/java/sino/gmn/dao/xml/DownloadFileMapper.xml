<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="sino.gmn.dao.DownloadFileMapper">
	<resultMap id="DownloadFileMap" type="sino.gmn.entity.DownloadFile">
		<result column="id" jdbcType="INTEGER" property="id" />
		<result column="name" jdbcType="VARCHAR" property="name" />
		<result column="url" jdbcType="VARCHAR" property="url" />
		<result column="user" jdbcType="VARCHAR" property="user" />
		<result column="comments" jdbcType="VARCHAR" property="comments" />
		<result column="flag" jdbcType="INTEGER" property="flag" />
		<result column="upload_file_date" jdbcType="TIMESTAMP"
			property="uploadFileDate" />
		<result column="download_file_date" jdbcType="TIMESTAMP"
			property="downloadFileDate" />
	</resultMap>

	<insert id="addDownloadFile">
		insert into download_file (id, name, url,
		user, comments, flag,
		upload_file_date, download_file_date)
		values (#{id,jdbcType=INTEGER}, #{name,jdbcType=VARCHAR},
		#{url,jdbcType=VARCHAR},
		#{user,jdbcType=VARCHAR}, #{comments,jdbcType=VARCHAR}, #{flag,jdbcType=INTEGER},
		#{uploadFileDate,jdbcType=TIMESTAMP},
		#{downloadFileDate,jdbcType=TIMESTAMP})
	</insert>

	<update id="deleteDownloadFile">
		update download_file set flag = 0 where id = #{id}
	</update>

	<!-- <delete id="deleteDownloadFile"> delete from download_file where id 
		= #{id} </delete> -->

	<update id="updateDownloadFile">
		update download_file
		set name = #{name,jdbcType=VARCHAR},
		url = #{url,jdbcType=VARCHAR},
		user = #{user,jdbcType=VARCHAR},
		comments = #{comments,jdbcType=VARCHAR},
		flag = #{flag,jdbcType=INTEGER},
		upload_file_date = #{uploadFileDate,jdbcType=TIMESTAMP},
		download_file_date = #{downloadFileDate,jdbcType=TIMESTAMP}
		where id = #{id,jdbcType=INTEGER};
	</update>

	<select id="searchDownloadFile" resultMap="DownloadFileMap">
		select id, name, url, user, comments, flag, upload_file_date,
		download_file_date from download_file where id = #{id}
	</select>

	<select id="countParamOrder" resultType="int">
		select count(id) from download_file where
		<if test="null!=param1 and ''!=param1 and null!=param2 and ''!=param2">
			${param1} like "%"#{param2}"%" and
		</if>
		flag=1
	</select>

	<select id="searchPageParamOrder" resultMap="DownloadFileMap">
		select id, name, url, user, comments, flag, upload_file_date,
		download_file_date
		from download_file where
		<if test="null!=param1 and ''!=param1 and null!=param2 and ''!=param2">
			${param1} like "%"#{param2}"%" and
		</if>
		flag=1
		<if test="null!=sort and ''!=sort and null!=order and ''!=order">
			order by ${sort}
			<if test="'asc'==order">
				asc
			</if>
			<if test="'desc'==order">
				desc
			</if>
		</if>
		limit #{page},#{rows}
	</select>

</mapper>